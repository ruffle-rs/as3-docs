<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="en-us" name="lang"/>
  <meta content="livedocs" name="area"/>
  <title>
   Adobe Flash Platform * Retrieving data from a database
  </title>
  <link href="images/AIR.ico" rel="shortcut icon"/>
  <meta content="HTML Developer’s Guide for Adobe AIR" name="book"/>
  <meta content="adobe" name="product"/>
  <meta content="air" name="product"/>
  <meta content="flash" name="product"/>
  <meta content="flex" name="product"/>
  <meta content="" name="keywords"/>
  <!--<PageMap><DataObject type="document"><Attribute name="product" value="adobe"></Attribute><Attribute name="product" value="air"></Attribute><Attribute name="product" value="flash"></Attribute><Attribute name="product" value="flex"></Attribute><Attribute name="book" value="HTML Developer’s Guide for Adobe AIR"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
  <script charset="UTF-8" language="Javascript" type="text/javascript">
   <!--[CDATA[
        var currentTreeNode = "WS5b3ccc516d4fbf351e63e3d118666ade46-7d27.html";
// ]]-->
  </script>
  <script charset="UTF-8" language="Javascript" src="terms.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="help.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="utilities.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="event.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="treeview.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="toc.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="swfobject.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="booklist.js" type="text/javascript">
   ..
  </script>
  <script type="text/javascript">
   <!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
  </script>
  
<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	//document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
    // DO NOTHING
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->


  
  
  <link href="tree.css" rel="stylesheet" type="text/css"/>
  <link href="content.css" rel="stylesheet" type="text/css"/>
  <link href="localeSpecific.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="content_body" onload="window.focus();">
  <a name="top" shape="rect">
   <!--LeaveCommentHere-->
  </a>
  <div id="mnemonic">
   <!--googleoff: index-->
   <div class="AIR" xmlns:adobe="http://www.adobe.com/saxon">
    <div class="banner">
     <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
      Adobe Flash Platform
     </a>
    </div>
   </div>
   <!--googleon: index-->
  </div>
  <div id="searchbar">
   <table id="searchbartable">
    <tr>
     <td colspan="2">
      <!--googleoff: index-->
      <div xmlns:adobe="http://www.adobe.com/saxon">
       <div id="pdf">
        <img height="16" src="images/PDF.gif" width="16"/>
        <a href="air_htmldevguide.pdf" title="View Help PDF">
         View Help PDF (
         5.8M
         B)
        </a>
       </div>
      </div>
      <!--googleon: index-->
     </td>
    </tr>
   </table>
  </div>
  <!-- BEGIN SEARCH CONTENT -->
  <form action="https://help.adobe.com/en_US/air/html/dev/search.html" id="search" name="search" target="_self">
   <script type="text/javascript">
    <!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
}

// ]]-->
   </script>
  </form>
  <!-- END SEARCH CONTENT -->
  <!-- BEGIN PAGE CONTENT WRAPPER -->
  <div id="page_content_wrapper">
   <!-- BEGIN PAGE WRAPPER -->
   <table id="page_content_table">
    <tr>
     
     <td id="col2">
      <!-- BEGIN CONTENT WRAPPER -->
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d42.html" title="Using parameters in statements">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d4b.html" title="Inserting data">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          HTML Developer’s Guide for Adobe AIR
         </b>
        </a>
        /
        <a href="WS789ea67d3e73a8b2-56af28411242c603f1f-8000.html">
         <b>
          Files and data
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118676a5497-7fb4.html">
         <b>
          Working with local SQL databases in AIR
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d27.html">
         <b>
          Manipulating SQL database data
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <div id="content_wrapper">
       <!-- BEGIN PAGE TITLE -->
       <h1>
        Retrieving data from a database
       </h1>
       <p class="adoberuntime">
        Adobe AIR 1.0 and later
       </p>
       <!-- END PAGE TITLE -->
       <!-- BEGIN IONCOMMENTCOUNT -->
       <div id="ionCount">
       </div>
       <!-- END IONCOMMENTCOUNT -->
       <table border="0" cellpadding="0" cellspacing="0" id="inner_content_table" width="100%">
        <tr>
         <td>
          <div style="border-top:#ccc solid 1px;">
           <p>
           </p>
          </div>
          <p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>


          <div id="minitoc">
           <div class="t">
            <div class="b">
             <div>
              <ul id="minitoc-links">
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118666ade46-7d21">
                  <span class="topictitle1">
                   Executing a SELECT statement
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118666ade46-7d16">
                  <span class="topictitle1">
                   Accessing SELECT statement result data
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118666ade46-7d15">
                  <span class="topictitle1">
                   Defining the data type of SELECT result data
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118666ade46-7d46">
                  <span class="topictitle1">
                   Retrieving SELECT results in parts
                  </span>
                 </a>
                </p>
               </li>
              </ul>
             </div>
            </div>
           </div>
          </div>
          <div>
           <p>
            Retrieving
data from a database involves two steps. First, you execute a SQL
            <samp class="codeph">
             SELECT
            </samp>
            statement,
describing the set of data you want from the database. Next, you
access the retrieved data and display or manipulate it as needed
by your application.
           </p>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118666ade46-7d21">
           <a name="WS5b3ccc516d4fbf351e63e3d118666ade46-7d21">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Executing a SELECT statement
           </h2>
           <div>
            <p>
             To retrieve existing data from
a database, you use a
             <a href="../../reference/html/flash/data/SQLStatement.html">
              SQLStatement
             </a>
             instance. Assign
the appropriate SQL
             <samp class="codeph">
              SELECT
             </samp>
             statement to the instance’s
             <samp class="codeph">
              text
             </samp>
             property, then
call its
             <samp class="codeph">
              execute()
             </samp>
             method.
            </p>
            <p>
             For details on the syntax of the
             <samp class="codeph">
              SELECT
             </samp>
             statement,
see
             <a href="WS112915e91f2778507c29b8cc1256b9c36a3-8000.html">
              SQL support in local databases
             </a>
             .
            </p>
            <p>
             The following example demonstrates executing a
             <samp class="codeph">
              SELECT
             </samp>
             statement
to retrieve data from a table named “products,” using asynchronous
execution mode:
            </p>
            <pre>// Include AIRAliases.js to use air.* shortcuts 
     
var selectStmt = new air.SQLStatement(); 
     
// A SQLConnection named "conn" has been created previously 
selectStmt.sqlConnection = conn; 
     
selectStmt.text = "SELECT itemId, itemName, price FROM products"; 
     
selectStmt.addEventListener(air.SQLEvent.RESULT, resultHandler); 
selectStmt.addEventListener(air.SQLErrorEvent.ERROR, errorHandler); 
     
selectStmt.execute(); 
     
function resultHandler(event) 
{ 
    var result = selectStmt.getResult(); 
     
    var numResults = result.data.length; 
    for (i = 0; i &lt; numResults; i++) 
    { 
        var row = result.data[i]; 
        var output = "itemId: " + row.itemId; 
        output += "; itemName: " + row.itemName; 
        output += "; price: " + row.price; 
        air.trace(output); 
    } 
} 
     
function errorHandler(event) 
{ 
    // Information about the error is available in the 
    // event.error property, which is an instance of  
    // the SQLError class. 
}</pre>
            <p>
             The following example demonstrates executing a
             <samp class="codeph">
              SELECT
             </samp>
             statement
to retrieve data from a table named “products,” using synchronous
execution mode:
            </p>
            <pre>// Include AIRAliases.js to use air.* shortcuts 
     
var selectStmt = new air.SQLStatement(); 
     
// A SQLConnection named "conn" has been created previously 
selectStmt.sqlConnection = conn; 
     
selectStmt.text = "SELECT itemId, itemName, price FROM products"; 
     
try 
{ 
    selectStmt.execute(); 
     
    var result = selectStmt.getResult(); 
     
    var numResults = result.data.length; 
    for (i = 0; i &lt; numResults; i++) 
    { 
        var row = result.data[i]; 
        var output = "itemId: " + row.itemId; 
        output += "; itemName: " + row.itemName; 
        output += "; price: " + row.price; 
        air.trace(output); 
    } 
} 
catch (error) 
{ 
    // Information about the error is available in the 
    // error variable, which is an instance of  
    // the SQLError class. 
}</pre>
            <p>
             In asynchronous execution mode, when the statement finishes executing,
the SQLStatement instance dispatches a
             <samp class="codeph">
              result
             </samp>
             event
(
             <samp class="codeph">
              SQLEvent.RESULT
             </samp>
             ) indicating that the statement
was run successfully. Alternatively, if a
             <a href="../../reference/html/flash/net/Responder.html">
              Responder
             </a>
             object
is passed as an argument to the
             <samp class="codeph">
              execute()
             </samp>
             method,
the Responder object’s result handler function is called. In synchronous
execution mode, execution pauses until the
             <samp class="codeph">
              execute()
             </samp>
             operation
completes, then continues on the next line of code.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118666ade46-7d16">
           <a name="WS5b3ccc516d4fbf351e63e3d118666ade46-7d16">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Accessing SELECT statement result data
           </h2>
           <div>
            <p>
             Once the
             <samp class="codeph">
              SELECT
             </samp>
             statement has finished executing,
the next step is to access the data that was retrieved. You retrieve
the result data from executing a
             <samp class="codeph">
              SELECT
             </samp>
             statement
by calling the SQLStatement object’s
             <samp class="codeph">
              getResult()
             </samp>
             method:
            </p>
            <pre>var result = selectStatement.getResult();</pre>
            <p>
             The
             <samp class="codeph">
              getResult()
             </samp>
             method returns a
             <a href="../../reference/html/flash/data/SQLResult.html">
              SQLResult
             </a>
             object.
The SQLResult object’s
             <samp class="codeph">
              data
             </samp>
             property is an Array
containing the results of the
             <samp class="codeph">
              SELECT
             </samp>
             statement:
            </p>
            <pre>var numResults = result.data.length; 
for (var i = 0; i &lt; numResults; i++) 
{ 
    // row is an Object representing one row of result data 
    var row = result.data[i]; 
}</pre>
            <p>
             Each row of data in the
             <samp class="codeph">
              SELECT
             </samp>
             result set becomes
an Object instance contained in the
             <samp class="codeph">
              data
             </samp>
             Array.
That object has properties whose names match the result set’s column
names. The properties contain the values from the result set’s columns. For
example, suppose a
             <samp class="codeph">
              SELECT
             </samp>
             statement specifies a
result set with three columns named “itemId,” “itemName,” and “price.”
For each row in the result set, an Object instance is created with
properties named
             <samp class="codeph">
              itemId
             </samp>
             ,
             <samp class="codeph">
              itemName
             </samp>
             ,
and
             <samp class="codeph">
              price
             </samp>
             . Those properties contain the values
from their respective columns.
            </p>
            <p>
             The following code listing defines a SQLStatement instance whose
text is a
             <samp class="codeph">
              SELECT
             </samp>
             statement. The statement retrieves
rows containing the
             <samp class="codeph">
              firstName
             </samp>
             and
             <samp class="codeph">
              lastName
             </samp>
             column
values of all the rows of a table named
             <samp class="codeph">
              employees
             </samp>
             .
This example uses asynchronous execution mode. When the execution
completes, the
             <samp class="codeph">
              selectResult()
             </samp>
             method is called,
and the resulting rows of data are accessed using
             <samp class="codeph">
              SQLStatement.getResult()
             </samp>
             and
displayed using the
             <samp class="codeph">
              trace()
             </samp>
             method. Note that this
listing assumes there is a SQLConnection instance named
             <samp class="codeph">
              conn
             </samp>
             that
has already been instantiated and is already connected to the database.
It also assumes that the “employees” table has already been created
and populated with data.
            </p>
            <pre>// Include AIRAliases.js to use air.* shortcuts 
     
// ... create and open the SQLConnection instance named conn ... 
     
// create the SQL statement 
var selectStmt = new air.SQLStatement(); 
selectStmt.sqlConnection = conn; 
     
// define the SQL text 
var sql =  
    "SELECT firstName, lastName " +  
    "FROM employees"; 
selectStmt.text = sql; 
     
// register listeners for the result and error events 
selectStmt.addEventListener(air.SQLEvent.RESULT, selectResult); 
selectStmt.addEventListener(air.SQLErrorEvent.ERROR, selectError); 
     
// execute the statement 
selectStmt.execute(); 
     
function selectResult(event) 
{ 
    // access the result data 
    var result = selectStmt.getResult(); 
     
    var numRows = result.data.length; 
    for (i = 0; i &lt; numRows; i++) 
    { 
        var output = ""; 
        for (columnName in result.data[i]) 
        { 
            output += columnName + ": " + result.data[i][columnName] + "; "; 
        } 
        air.trace("row[" + i.toString() + "]\t", output); 
    } 
} 
     
function selectError(event) 
{ 
    air.trace("Error message:", event.error.message); 
    air.trace("Details:", event.error.details); 
}</pre>
            <p>
             The following code listing demonstrates the same techniques as
the preceding one, but uses synchronous execution mode. The example
defines a
             <a href="../../reference/html/flash/data/SQLStatement.html">
              SQLStatement
             </a>
             instance whose
text is a
             <samp class="codeph">
              SELECT
             </samp>
             statement. The statement retrieves
rows containing the
             <samp class="codeph">
              firstName
             </samp>
             and
             <samp class="codeph">
              lastName
             </samp>
             column
values of all the rows of a table named
             <samp class="codeph">
              employees
             </samp>
             .
The resulting rows of data are accessed using
             <samp class="codeph">
              SQLStatement.getResult()
             </samp>
             and
displayed using the
             <samp class="codeph">
              trace()
             </samp>
             method. Note that this
listing assumes there is a SQLConnection instance named
             <samp class="codeph">
              conn
             </samp>
             that
has already been instantiated and is already connected to the database.
It also assumes that the “employees” table has already been created and
populated with data.
            </p>
            <pre>// Include AIRAliases.js to use air.* shortcuts 
     
// ... create and open the SQLConnection instance named conn ... 
     
// create the SQL statement 
var selectStmt = new air.SQLStatement(); 
selectStmt.sqlConnection = conn; 
     
// define the SQL text 
var sql =  
    "SELECT firstName, lastName " +  
    "FROM employees"; 
selectStmt.text = sql; 
     
try 
{ 
    // execute the statement 
    selectStmt.execute(); 
     
    // access the result data 
    var result = selectStmt.getResult(); 
     
    var numRows = result.data.length; 
    for (i = 0; i &lt; numRows; i++) 
    { 
        var output = ""; 
        for (columnName in result.data[i]) 
        { 
            output += columnName + ": " + result.data[i][columnName] + "; "; 
        } 
        air.trace("row[" + i.toString() + "]\t", output); 
    } 
} 
catch (error) 
{ 
    air.trace("Error message:", error.message); 
    air.trace("Details:", error.details); 
}</pre>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118666ade46-7d15">
           <a name="WS5b3ccc516d4fbf351e63e3d118666ade46-7d15">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Defining the data type of SELECT result data
           </h2>
           <div>
            <p>
             By default, each row returned by a
             <samp class="codeph">
              SELECT
             </samp>
             statement
is created as an Object instance with properties named for the result
set's column names and with the value of each column as the value
of its associated property. However, before executing a SQL
             <samp class="codeph">
              SELECT
             </samp>
             statement,
you can set the
             <samp class="codeph">
              itemClass
             </samp>
             property of the
             <a href="../../reference/html/flash/data/SQLStatement.html">
              SQLStatement
             </a>
             instance
to a class. By setting the
             <samp class="codeph">
              itemClass
             </samp>
             property,
each row returned by the
             <samp class="codeph">
              SELECT
             </samp>
             statement is created
as an instance of the designated class. The runtime assigns result
column values to property values by matching the column names in
the
             <samp class="codeph">
              SELECT
             </samp>
             result set to the names of the properties
in the
             <samp class="codeph">
              itemClass
             </samp>
             class.
            </p>
            <p>
             Any class assigned as an
             <samp class="codeph">
              itemClass
             </samp>
             property
value must have a constructor that does not require any parameters.
In addition, the class must have a single property for each column
returned by the
             <samp class="codeph">
              SELECT
             </samp>
             statement. It is considered
an error if a column in the
             <samp class="codeph">
              SELECT
             </samp>
             list does not
have a matching property name in the
             <samp class="codeph">
              itemClass
             </samp>
             class.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118666ade46-7d46">
           <a name="WS5b3ccc516d4fbf351e63e3d118666ade46-7d46">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Retrieving SELECT results in parts
           </h2>
           <div>
            <p>
             By default, a
             <samp class="codeph">
              SELECT
             </samp>
             statement execution retrieves
all the rows of the result set at one time. Once the statement completes,
you usually process the retrieved data in some way, such as creating
objects or displaying the data on the screen. If the statement returns
a large number of rows, processing all the data at once can be demanding
for the computer, which in turn will cause the user interface to
not redraw itself.
            </p>
            <p>
             You can improve the perceived performance of your application
by instructing the runtime to return a specific number of result
rows at a time. Doing so causes the initial result data to return
more quickly. It also allows you to divide the result rows into
sets, so that the user interface is updated after each set of rows
is processed. Note that it’s only practical to use this technique
in asynchronous execution mode.
            </p>
            <p>
             To retrieve
             <samp class="codeph">
              SELECT
             </samp>
             results in parts, specify
a value for the
             <samp class="codeph">
              SQLStatement.execute()
             </samp>
             method’s
first parameter (the
             <samp class="codeph">
              prefetch
             </samp>
             parameter). The
             <samp class="codeph">
              prefetch
             </samp>
             parameter
indicates the number of rows to retrieve the first time the statement
executes. When you call a
             <a href="../../reference/html/flash/data/SQLStatement.html">
              SQLStatement
             </a>
             instance’s
             <samp class="codeph">
              execute()
             </samp>
             method,
specify a
             <samp class="codeph">
              prefetch
             </samp>
             parameter value and only that
many rows are retrieved:
            </p>
            <pre>// Include AIRAliases.js to use air.* shortcuts 
var stmt = new air.SQLStatement(); 
stmt.sqlConnection = conn; 
     
stmt.text = "SELECT ..."; 
     
stmt.addEventListener(air.SQLEvent.RESULT, selectResult); 
     
stmt.execute(20); // only the first 20 rows (or fewer) are returned</pre>
            <p>
             The statement dispatches the
             <samp class="codeph">
              result
             </samp>
             event, indicating
that the first set of result rows is available. The resulting
             <a href="../../reference/html/flash/data/SQLResult.html">
              SQLResult
             </a>
             instance’s
             <samp class="codeph">
              data
             </samp>
             property
contains the rows of data, and its
             <samp class="codeph">
              complete
             </samp>
             property
indicates whether there are additional result rows to retrieve.
To retrieve additional result rows, call the SQLStatement instance’s
             <samp class="codeph">
              next()
             </samp>
             method.
Like the
             <samp class="codeph">
              execute()
             </samp>
             method, the
             <samp class="codeph">
              next()
             </samp>
             method’s
first parameter is used to indicate how many rows to retrieve the
next time the result event is dispatched.
            </p>
            <pre>function selectResult(event) 
{ 
    var result = stmt.getResult(); 
    if (result.data != null) 
    { 
        // ... loop through the rows or perform other processing ... 
         
        if (!result.complete) 
        { 
            stmt.next(20); // retrieve the next 20 rows 
        } 
        else 
        { 
            stmt.removeEventListener(air.SQLEvent.RESULT, selectResult); 
        } 
    } 
}</pre>
            <p>
             The SQLStatement dispatches a
             <samp class="codeph">
              result
             </samp>
             event each
time the
             <samp class="codeph">
              next()
             </samp>
             method returns a subsequent set
of result rows. Consequently, the same listener function can be
used to continue processing results (from
             <samp class="codeph">
              next()
             </samp>
             calls)
until all the rows are retrieved.
            </p>
            <p>
             For more information, see the descriptions for the
             <samp class="codeph">
              SQLStatement.execute()
             </samp>
             method
(the
             <samp class="codeph">
              prefetch
             </samp>
             parameter description) and the
             <samp class="codeph">
              SQLStatement.next()
             </samp>
             method.
            </p>
           </div>
          </div>
          <!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
          <!-- END USER PREFERENCES -->
          <div id="related">
           <div class="separator">
            <a href="#top">
             <img src="images/BTT.jpg"/>
            </a>
           </div>
          </div>
          <div id="footer">
           <!-- BEGIN IONCOMMENTS -->
           <div id="ionComHere">
           </div>
           <!-- END IONCOMMENTS -->
           

           <p id="creativecommons">
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text">
             <img alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" id="creativecommons_img" src="images/CC.png"/>
            </a>
            Twitter™ and Facebook posts are not covered under the terms of Creative Commons.
           </p>
          </div>
         </td>
         <td width="10px">
         </td>
         <td id="inner_rightcolumn">
          
         </td>
        </tr>
       </table>
      </div>
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d42.html" title="Using parameters in statements">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d4b.html" title="Inserting data">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          HTML Developer’s Guide for Adobe AIR
         </b>
        </a>
        /
        <a href="WS789ea67d3e73a8b2-56af28411242c603f1f-8000.html">
         <b>
          Files and data
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118676a5497-7fb4.html">
         <b>
          Working with local SQL databases in AIR
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118666ade46-7d27.html">
         <b>
          Manipulating SQL database data
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <!-- END CONTENT WRAPPER -->
      
     </td>
     <td id="col3">
      <div>
       <img src="images/adobe-lq.png"/>
      </div>
     </td>
    </tr>
   </table>
  </div>
  <!-- END PAGE CONTENT WRAPPER -->
  <script type="text/javascript">
   <!--[CDATA[
scrollToNameAnchor();
// ]]-->
  </script>
  <!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/framemaker/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
		path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



  <style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 


remove_all_cookies();

function remove_all_cookies() {
	var res = document.cookie;
    var multiple = res.split(";");
    for(var i = 0; i < multiple.length; i++) {
    	var key = multiple[i].split("=");
        document.cookie = key[0]+" =; expires = Thu, 01 Jan 1970 00:00:00 UTC";
    }
}


</script>
</p>


  
<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>

//  Ethnio survey code removed
  
  
 </body>
</html>