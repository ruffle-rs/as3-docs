<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="en-us" name="lang"/>
  <meta content="livedocs" name="area"/>
  <title>
   Adobe Flash Platform * Implementing the IURIDereferencer interface
  </title>
  <link href="images/AIR.ico" rel="shortcut icon"/>
  <meta content="HTML Developer’s Guide for Adobe AIR" name="book"/>
  <meta content="adobe" name="product"/>
  <meta content="air" name="product"/>
  <meta content="flash" name="product"/>
  <meta content="flex" name="product"/>
  <meta content="" name="keywords"/>
  <!--<PageMap><DataObject type="document"><Attribute name="product" value="adobe"></Attribute><Attribute name="product" value="air"></Attribute><Attribute name="product" value="flash"></Attribute><Attribute name="product" value="flex"></Attribute><Attribute name="book" value="HTML Developer’s Guide for Adobe AIR"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
  <script charset="UTF-8" language="Javascript" type="text/javascript">
   <!--[CDATA[
        var currentTreeNode = "WS93f497c3840e6eaf-6419d18d11c4e2bbf5a-8000.html";
// ]]-->
  </script>
  <script charset="UTF-8" language="Javascript" src="terms.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="help.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="utilities.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="event.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="treeview.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="toc.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="swfobject.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="booklist.js" type="text/javascript">
   ..
  </script>
  <script type="text/javascript">
   <!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
  </script>
  
<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	//document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
    // DO NOTHING
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->


  
  
  <link href="tree.css" rel="stylesheet" type="text/css"/>
  <link href="content.css" rel="stylesheet" type="text/css"/>
  <link href="localeSpecific.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="content_body" onload="window.focus();">
  <a name="top" shape="rect">
   <!--LeaveCommentHere-->
  </a>
  <div id="mnemonic">
   <!--googleoff: index-->
   <div class="AIR" xmlns:adobe="http://www.adobe.com/saxon">
    <div class="banner">
     <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
      Adobe Flash Platform
     </a>
    </div>
   </div>
   <!--googleon: index-->
  </div>
  <div id="searchbar">
   <table id="searchbartable">
    <tr>
     <td colspan="2">
      <!--googleoff: index-->
      <div xmlns:adobe="http://www.adobe.com/saxon">
       <div id="pdf">
        <img height="16" src="images/PDF.gif" width="16"/>
        <a href="air_htmldevguide.pdf" title="View Help PDF">
         View Help PDF (
         5.8M
         B)
        </a>
       </div>
      </div>
      <!--googleon: index-->
     </td>
    </tr>
   </table>
  </div>
  <!-- BEGIN SEARCH CONTENT -->
  <form action="https://help.adobe.com/en_US/air/html/dev/search.html" id="search" name="search" target="_self">
   <script type="text/javascript">
    <!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
}

// ]]-->
   </script>
  </form>
  <!-- END SEARCH CONTENT -->
  <!-- BEGIN PAGE CONTENT WRAPPER -->
  <div id="page_content_wrapper">
   <!-- BEGIN PAGE WRAPPER -->
   <table id="page_content_table">
    <tr>
     
     <td id="col2">
      <!-- BEGIN CONTENT WRAPPER -->
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS0d09d76dc8b209fc-4cec51c711c2bd135a5-8000.html" title="About XML signatures">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WSb2ba3b1aad8a27b01f725f40124e9b4c9e6-8000.html" title="Media">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          HTML Developer’s Guide for Adobe AIR
         </b>
        </a>
        /
        <a href="WS789ea67d3e73a8b2-56af28411242c603f1f-8000.html">
         <b>
          Files and data
         </b>
        </a>
        /
        <a href="WS887c509e5469a884909031a11c299fac04-8000.html">
         <b>
          XML signature validation in AIR
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <div id="content_wrapper">
       <!-- BEGIN PAGE TITLE -->
       <h1>
        Implementing the IURIDereferencer interface
       </h1>
       <p class="adoberuntime">
        Adobe AIR 1.5 and later
       </p>
       <!-- END PAGE TITLE -->
       <!-- BEGIN IONCOMMENTCOUNT -->
       <div id="ionCount">
       </div>
       <!-- END IONCOMMENTCOUNT -->
       <table border="0" cellpadding="0" cellspacing="0" id="inner_content_table" width="100%">
        <tr>
         <td>
          <div style="border-top:#ccc solid 1px;">
           <p>
           </p>
          </div>
          <p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>


          <div id="minitoc">
           <div class="t">
            <div class="b">
             <div>
              <ul id="minitoc-links">
               <li>
                <p>
                 <a href="#WS93f497c3840e6eaf-166313b411c4e5795f2-8000">
                  <span class="topictitle1">
                   Dereferencing URIs in enveloped signatures
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS93f497c3840e6eaf-166313b411c4e5795f2-7fff">
                  <span class="topictitle1">
                   Dereferencing URIs in enveloping and detached signatures
                  </span>
                 </a>
                </p>
                <ul>
                 <li>
                  <p>
                   <a href="#WSe3d2d529026165532269532f11c52167396-8000">
                    <span class="topictitle2">
                     Computing digest values for external resources
                    </span>
                   </a>
                  </p>
                 </li>
                </ul>
               </li>
               <li>
                <p>
                 <a href="#WS93f497c3840e6eaf-166313b411c4e5795f2-7ffe">
                  <span class="topictitle1">
                   Dereferencing URIs in detached signatures referencing external data
                  </span>
                 </a>
                </p>
               </li>
              </ul>
             </div>
            </div>
           </div>
          </div>
          <div>
           <p>
            To
validate an XML signature, you must provide an implementation of
the IURIDereferencer interface. The implementation is responsible
for resolving the URIs within the Reference elements of an XML signature
document and returning the data so that the digest can be computed.
The computed digest is compared with the digest in the signature
to determine if the referenced data has been altered since the signature
was created.
           </p>
           <div class="note">
            <span class="notetitle">
             Note:
            </span>
            HTML-based AIR applications must import a SWF library containing
an ActionScript implementation in order to validate XML signatures.
The IURIDereferencer interface cannot be implemented in JavaScript.
           </div>
           <p>
            The IURIDerefencer interface has a single method,
            <samp class="codeph">
             dereference(uri:String)
            </samp>
            ,
that must be implemented. The XMLSignatureValidator object calls
this method for each reference in the signature. The method must
return the data in a ByteArray object.
           </p>
           <p>
            In most cases, you will also need to add properties or methods
that allow your dereferencer object to locate the referenced data.
For example, if the signed data is located in the same document
as the signature, you could add a member variable that provides
a reference to the XML document. The
            <samp class="codeph">
             dereference()
            </samp>
            method
can then use this variable, along with the URI, to locate the referenced data.
Likewise, if the signed data is located in a directory of the local
file system, the
            <samp class="codeph">
             dereference()
            </samp>
            method might need
a property providing the path to that directory in order to resolve
the referenced files.
           </p>
           <p>
            The XMLSignatureValidator relies entirely on the dereferencer
for interpreting URI strings. The standard rules for dereferencing
URIs are given in the section 4.3.3 of the W3C Recommendation for
XML Signature Syntax and Processing.
           </p>
          </div>
          <div class="nochunk" id="WS93f497c3840e6eaf-166313b411c4e5795f2-8000">
           <a name="WS93f497c3840e6eaf-166313b411c4e5795f2-8000">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Dereferencing URIs in enveloped signatures
           </h2>
           <div>
            <p>
             When an enveloped XML signature is generated, the signature elements
are inserted into the signed data. For example, if you signed the
following message using an enveloped signature structure:
            </p>
            <pre>&lt;message&gt; 
    &lt;data&gt;...&lt;/data&gt; 
&lt;/message&gt;</pre>
            <p>
             The resulting signed document will look like this:
            </p>
            <pre>&lt;message&gt; 
    &lt;data&gt;...&lt;/data&gt; 
     &lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#"&gt; 
        &lt;SignedInfo&gt; 
            &lt;CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/&gt; 
            &lt;SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt; 
            &lt;Reference URI=""&gt; 
                &lt;Transforms&gt; 
                    &lt;Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/&gt; 
                &lt;/Transforms&gt; 
                &lt;DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/&gt; 
                &lt;DigestValue&gt;yv6...Z0Y=&lt;/DigestValue&gt; 
            &lt;/Reference&gt; 
        &lt;/SignedInfo&gt; 
        &lt;SignatureValue&gt;cCY...LQ==&lt;/SignatureValue&gt; 
        &lt;KeyInfo&gt; 
            &lt;X509Data&gt; 
                &lt;X509Certificate&gt;MII...4e&lt;/X509Certificate&gt; 
            &lt;/X509Data&gt; 
        &lt;/KeyInfo&gt; 
    &lt;/Signature&gt; 
&lt;/message&gt;</pre>
            <p>
             Notice that the signature contains a single Reference element
with an empty string as its URI. An empty string in this context
refers to the root of the document.
            </p>
            <p>
             Also notice that the transform algorithm specifies that an enveloped
signature transform has been applied. When an enveloped signature
transform has been applied, the XMLSignatureValidator automatically
removes the signature from the document before computing the digest.
This means that the dereferencer does not need to remove the Signature
element when returning the data.
            </p>
            <p>
             The following example illustrates a dereferencer for enveloped
signatures:
            </p>
            <pre>package 
{ 
    import flash.events.ErrorEvent; 
      import flash.events.EventDispatcher;  
    import flash.security.IURIDereferencer; 
    import flash.utils.ByteArray; 
    import flash.utils.IDataInput; 
 
    public class EnvelopedDereferencer 
        extends EventDispatcher implements IURIDereferencer 
    { 
        private var signedMessage:XML; 
         
        public function EnvelopedDereferencer( signedMessage:XML ) 
        { 
            this.signedMessage = signedMessage; 
        } 
 
        public function dereference( uri:String ):IDataInput 
        { 
            try 
            { 
                if( uri.length != 0 ) 
                { 
                    throw( new Error("Unsupported signature type.") ); 
                } 
                var data:ByteArray = new ByteArray(); 
                data.writeUTFBytes( signedMessage.toXMLString() ); 
                data.position = 0; 
            } 
            catch (e:Error) 
                { 
                var error:ErrorEvent = 
                    new ErrorEvent("Ref error " + uri + " ", false, false, e.message); 
                this.dispatchEvent(error); 
                data = null; 
                throw new Error("Reference not resolvable: " + uri + ", " + e.message); 
            } 
            finally 
            { 
                return data; 
            } 
        }         
    } 
}</pre>
            <p>
             This dereferencer class uses a constructor function with a parameter,
             <samp class="codeph">
              signedMessage
             </samp>
             ,
to make the enveloped signature document available to the
             <samp class="codeph">
              dereference()
             </samp>
             method.
Since the reference in an enveloped signature always refers to the
root of the signed data, the
             <samp class="codeph">
              dereferencer()
             </samp>
             method writes
the document into a byte array and returns it.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS93f497c3840e6eaf-166313b411c4e5795f2-7fff">
           <a name="WS93f497c3840e6eaf-166313b411c4e5795f2-7fff">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Dereferencing URIs in enveloping and detached signatures
           </h2>
           <div>
            <p>
             When the signed data is located in the same document as the signature
itself, the URIs in the references typically use XPath or XPointer
syntax to address the elements that are signed. The W3C Recommendation
for XML Signature Syntax and Processing only recommends this syntax,
so you should base your implementation on the signatures you expect
to encounter (and add sufficient error checking to gracefully handle
unsupported syntax).
            </p>
            <p>
             The signature of an AIR application is an example of an enveloping
signature. The files in the application are listed in a Manifest
element. The Manifest element is addressed in the Reference URI
attribute using the string, “#PackageContents”, which refers to
the Id of the Manifest element:
            </p>
            <pre>&lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#" Id="PackageSignature"&gt; 
    &lt;SignedInfo&gt; 
        &lt;CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/&gt; 
        &lt;SignatureMethod Algorithm="http://www.w3.org/TR/xmldsig-core#rsa-sha1"/&gt; 
        &lt;Reference URI="#PackageContents"&gt; 
            &lt;Transforms&gt; 
                &lt;Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/&gt; 
            &lt;/Transforms&gt; 
            &lt;DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/&gt; 
            &lt;DigestValue&gt;ZMGqQdaRKQc1HirIRsDpeBDlaElS+pPotdziIAyAYDk=&lt;/DigestValue&gt; 
        &lt;/Reference&gt; 
    &lt;/SignedInfo&gt; 
    &lt;SignatureValue Id="PackageSignatureValue"&gt;cQK...7Zg==&lt;/SignatureValue&gt; 
    &lt;KeyInfo&gt; 
        &lt;X509Data&gt; 
            &lt;X509Certificate&gt;MII...T4e&lt;/X509Certificate&gt; 
        &lt;/X509Data&gt; 
    &lt;/KeyInfo&gt; 
    &lt;Object&gt; 
    &lt;Manifest Id="PackageContents"&gt; 
        &lt;Reference URI="mimetype"&gt; 
            &lt;DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"&gt; 
            &lt;/DigestMethod&gt; 
            &lt;DigestValue&gt;0/oCb84THKMagtI0Dy0KogEu92TegdesqRr/clXct1c=&lt;/DigestValue&gt; 
        &lt;/Reference&gt; 
        &lt;Reference URI="META-INF/AIR/application.xml"&gt; 
            &lt;DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"&gt; 
            &lt;/DigestMethod&gt; 
            &lt;DigestValue&gt;P9MqtqSdqcqnFgeoHCJysLQu4PmbUW2JdAnc1WLq8h4=&lt;/DigestValue&gt; 
        &lt;/Reference&gt; 
        &lt;Reference URI="XMLSignatureValidation.swf"&gt; 
            &lt;DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"&gt; 
            &lt;/DigestMethod&gt; 
            &lt;DigestValue&gt;OliRHRAgc9qt3Dk0m0Bi53Ur5ur3fAweIFwju74rFgE=&lt;/DigestValue&gt; 
        &lt;/Reference&gt; 
    &lt;/Manifest&gt; 
&lt;/Object&gt; 
&lt;/Signature&gt;</pre>
            <p>
             A dereferencer for validating this signature must take the URI
string containing,
             <samp class="codeph">
              "#PackageContents"
             </samp>
             from the
Reference element, and return the Manifest element in a ByteArray
object. The “#” symbol refers to the value of an element Id attribute.
            </p>
            <p>
             The following example implements a dereferencer for validating
AIR application signatures. The implementation is kept simple by
relying on the known structure of an AIR signature. A general-purpose
dereferencer could be significantly more complex.
            </p>
            <pre>package 
{ 
    import flash.events.ErrorEvent;    
    import flash.security.IURIDereferencer; 
    import flash.utils.ByteArray; 
    import flash.utils.IDataInput; 
     
    public class AIRSignatureDereferencer implements IURIDereferencer { 
        private const XML_SIG_NS:Namespace = 
            new Namespace( "http://www.w3.org/2000/09/xmldsig#" ); 
        private var airSignature:XML; 
     
        public function AIRSignatureDereferencer( airSignature:XML ) { 
            this.airSignature = airSignature; 
        } 
         
        public function dereference( uri:String ):IDataInput {     
            var data:ByteArray = null;     
            try 
            {     
                if( uri != "#PackageContents" ) 
                { 
                    throw( new Error("Unsupported signature type.") ); 
                } 
                var manifest:XMLList = 
                    airSignature.XML_SIG_NS::Object.XML_SIG_NS::Manifest; 
                data = new ByteArray(); 
                data.writeUTFBytes( manifest.toXMLString()); 
                data.position = 0; 
            } 
            catch (e:Error) 
            { 
                data = null; 
                throw new Error("Reference not resolvable: " + uri + ", " + e.message); 
            } 
            finally 
            { 
                return data; 
            } 
             
        } 
    } 
}</pre>
            <p>
             When you verify this type of signature, only the data in the
Manifest element is validated. The actual files in the package are
not checked at all. To check the package files for tampering, you
must read the files, compute the SHA256 digest and compare the result
to digest recorded in the manifest. The XMLSignatureValidator does
not automatically check such secondary references.
            </p>
            <div class="note">
             <span class="notetitle">
              Note:
             </span>
             This example is provided only to illustrate the signature
validation process. There is little use in an AIR application validating
its own signature. If the application has already been tampered
with, the tampering agent could simply remove the validation check.
            </div>
           </div>
           <div class="nochunk" id="WSe3d2d529026165532269532f11c52167396-8000">
            <a name="WSe3d2d529026165532269532f11c52167396-8000">
             <!-- -->
            </a>
            <h3 class="topictitle3">
             Computing digest values for external resources
            </h3>
            <div>
             <p>
              AIR does not include built-in functions for computing SHA256
digests, but the Flex SDK does include a SHA256 utility class. The
SDK also includes the Base64 encoder utility class that is helpful
for comparing the computed digest to the digest stored in a signature.
             </p>
             <p>
              The following example function reads and validates the files
in an AIR package manifest:
             </p>
             <pre>import mx.utils.Base64Encoder; 
import mx.utils.SHA256; 
 
private function verifyManifest( sigFile:File, manifest:XML ):Boolean 
{ 
    var result:Boolean = true; 
    var message:String = ''; 
    var nameSpace:Namespace = manifest.namespace(); 
     
    if( manifest.nameSpace::Reference.length() &lt;= 0 ) 
    { 
        result = false; 
        message = "Nothing to validate."; 
    } 
    for each (var reference:XML in manifest.nameSpace::Reference) 
    { 
        var file:File = sigFile.parent.parent.resolvePath( reference.@URI ); 
        var stream:FileStream = new FileStream(); 
        stream.open(file, FileMode.READ); 
        var fileData:ByteArray = new ByteArray(); 
        stream.readBytes( fileData, 0, stream.bytesAvailable ); 
 
        var digestHex:String = SHA256.computeDigest( fileData ); 
        //Convert hexidecimal string to byte array 
        var digest:ByteArray = new ByteArray(); 
        for( var c:int = 0; c &lt; digestHex.length; c += 2 ){ 
            var byteChar:String = digestHex.charAt(c) + digestHex.charAt(c+1); 
            digest.writeByte( parseInt( byteChar, 16 )); 
        } 
        digest.position = 0; 
         
        var base64Encoder:Base64Encoder = new Base64Encoder(); 
        base64Encoder.insertNewLines = false; 
        base64Encoder.encodeBytes( digest, 0, digest.bytesAvailable ); 
        var digestBase64:String = base64Encoder.toString(); 
        if( digestBase64 == reference.nameSpace::DigestValue ) 
        { 
            result = result &amp;&amp; true; 
            message += "   " + reference.@URI + " verified.\n"; 
        } 
        else 
        { 
            result = false; 
            message += " ---- " + reference.@URI + " has been modified!\n"; 
        } 
        base64Encoder.reset(); 
    } 
    trace( message ); 
    return result; 
}</pre>
             <p>
              The function loops through all the references in the Manifest
element. For each reference, the SHA256 digest is computed, encoded
in base64 format, and compared to the digest in the manifest. The
URIs in an AIR package refer to paths relative to the application
directory. The paths are resolved based on the location of the signature
file, which is always in the META-INF subdirectory within the application
directory. Note that the Flex SHA256 class returns the digest as
a string of hexadecimal characters. This string must be converted
into a ByteArray containing the bytes represented by the hexadecimal
string.
             </p>
             <p>
              To use the mx.utils.SHA256
and Base64Encoder classes in Flash CS4, you can either locate and
copy these classes into your application development directory or
compile a library SWF containing the classes using the Flex SDK.
             </p>
             <p>
              To use
the mx.utils.SHA256 and Base64Encoder classes in an HTML-based AIR
application, you can compile a library SWF containing the classes
using the Flex SDK and add the SWF to your HTML page using a
              <samp class="codeph">
               &lt;script&gt;
              </samp>
              tag.
             </p>
            </div>
           </div>
          </div>
          <div class="nochunk" id="WS93f497c3840e6eaf-166313b411c4e5795f2-7ffe">
           <a name="WS93f497c3840e6eaf-166313b411c4e5795f2-7ffe">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Dereferencing URIs in detached signatures referencing external data
           </h2>
           <div>
            <p>
             When a URI refers to an external resource, the data must be accessed
and loaded into a ByteArray object. If the URI contains an absolute
URL, then it is simply a matter of reading a file or requesting
a URL. If, as is probably the more common case, the URI contains
to a relative path, then your IURIDereferencer implementation must
include a way to resolve the paths to the signed files.
            </p>
            <p>
             The following example uses a File object initialized when the
dereferencer instance is constructed as the base for resolving signed
files.
            </p>
            <pre>package 
{ 
    import flash.events.ErrorEvent; 
    import flash.events.EventDispatcher; 
    import flash.filesystem.File; 
    import flash.filesystem.FileMode; 
    import flash.filesystem.FileStream; 
    import flash.security.IURIDereferencer; 
    import flash.utils.ByteArray; 
    import flash.utils.IDataInput; 
    public class RelativeFileDereferencer 
        extends EventDispatcher implements IURIDereferencer 
    { 
        private var base:File; 
         
        public function RelativeFileDereferencer( base:File ) 
        { 
            this.base = base; 
        } 
 
        public function dereference( uri:String ):IDataInput 
        { 
            var data:ByteArray = null; 
            try{ 
                var referent:File = this.base.resolvePath( uri ); 
                var refStream:FileStream = new FileStream();             
                data = new ByteArray(); 
                refStream.open( referent, FileMode.READ ); 
                 
                refStream.readBytes( data, 0, data.bytesAvailable ); 
                 
            } catch ( e:Error ) { 
                data = null; 
                throw new Error("Reference not resolvable: " + referent.nativePath + ", " + e.message ); 
            } finally { 
                return data; 
            } 
        }         
    } 
}</pre>
            <p>
             The
             <samp class="codeph">
              dereference()
             </samp>
             function simply locates the
file addressed by the reference URI, loads the file contents into
a byte array, and returns the ByteArray object.
            </p>
            <div class="note">
             <span class="notetitle">
              Note:
             </span>
             Before validating remote external references, consider whether
your application could be vulnerable to a “phone home” or similar
type of attack by a maliciously constructed signature document.
            </div>
           </div>
          </div>
          <!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
          <!-- END USER PREFERENCES -->
          <div id="related">
           <div class="separator">
            <a href="#top">
             <img src="images/BTT.jpg"/>
            </a>
           </div>
          </div>
          <div id="footer">
           <!-- BEGIN IONCOMMENTS -->
           <div id="ionComHere">
           </div>
           <!-- END IONCOMMENTS -->
           

           <p id="creativecommons">
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text">
             <img alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" id="creativecommons_img" src="images/CC.png"/>
            </a>
            Twitter™ and Facebook posts are not covered under the terms of Creative Commons.
           </p>
          </div>
         </td>
         <td width="10px">
         </td>
         <td id="inner_rightcolumn">
          
         </td>
        </tr>
       </table>
      </div>
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS0d09d76dc8b209fc-4cec51c711c2bd135a5-8000.html" title="About XML signatures">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WSb2ba3b1aad8a27b01f725f40124e9b4c9e6-8000.html" title="Media">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b-3d590ddd1272a3584c3-8000.html">
         <b>
          HTML Developer’s Guide for Adobe AIR
         </b>
        </a>
        /
        <a href="WS789ea67d3e73a8b2-56af28411242c603f1f-8000.html">
         <b>
          Files and data
         </b>
        </a>
        /
        <a href="WS887c509e5469a884909031a11c299fac04-8000.html">
         <b>
          XML signature validation in AIR
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <!-- END CONTENT WRAPPER -->
      
     </td>
     <td id="col3">
      <div>
       <img src="images/adobe-lq.png"/>
      </div>
     </td>
    </tr>
   </table>
  </div>
  <!-- END PAGE CONTENT WRAPPER -->
  <script type="text/javascript">
   <!--[CDATA[
scrollToNameAnchor();
// ]]-->
  </script>
  <!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/framemaker/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
		path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



  <style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 


remove_all_cookies();

function remove_all_cookies() {
	var res = document.cookie;
    var multiple = res.split(";");
    for(var i = 0; i < multiple.length; i++) {
    	var key = multiple[i].split("=");
        document.cookie = key[0]+" =; expires = Thu, 01 Jan 1970 00:00:00 UTC";
    }
}


</script>
</p>


  
<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>

//  Ethnio survey code removed
  
  
 </body>
</html>