<?xml version="1.0" encoding="UTF-8"?>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- saved from url=(0022)http://help.adobe.com/ -->
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="en-us" name="lang"/>
  <meta content="livedocs" name="area"/>
  <title>
   Adobe Flash Platform * Understanding the protected content workflow
  </title>
  <link href="https://help.adobe.com/en_US/as3/dev/images/FlashRuntimeLinkIndicator.png" rel="shortcut icon"/>
  <meta content="ActionScript 3.0 Developer’s Guide" name="book"/>
  <meta content="adobe" name="product"/>
  <meta content="air" name="product"/>
  <meta content="flash" name="product"/>
  <meta content="flex" name="product"/>
  <meta content="" name="keywords"/>
  <!--<PageMap><DataObject type="document"><Attribute name="product" value="adobe"></Attribute><Attribute name="product" value="air"></Attribute><Attribute name="product" value="flash"></Attribute><Attribute name="product" value="flex"></Attribute><Attribute name="book" value="ActionScript 3.0 Developer’s Guide"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
  <script charset="UTF-8" language="Javascript" type="text/javascript">
   <!--[CDATA[
        var currentTreeNode = "WS5b3ccc516d4fbf351e63e3d118666ade46-7ce3.html";
// ]]-->
  </script>
  <script charset="UTF-8" language="Javascript" src="terms.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="help.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="utilities.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="event.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="treeview.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="toc.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="swfobject.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="booklist.js" type="text/javascript">
   ..
  </script>
  <script type="text/javascript">
   <!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
  </script>
  
<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	//document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
    // DO NOTHING
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->


  
  
  <link href="tree.css" rel="stylesheet" type="text/css"/>
  <link href="content.css" rel="stylesheet" type="text/css"/>
  <link href="localeSpecific.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="content_body" onload="window.focus();">
  <a name="top" shape="rect">
   <!--LeaveCommentHere-->
  </a>
  <div id="mnemonic">
   <!--googleoff: index-->
   <div class="FlashRuntime" xmlns:adobe="http://www.adobe.com/saxon">
    <div class="banner">
     <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
      Adobe Flash Platform
     </a>
    </div>
   </div>
   <!--googleon: index-->
  </div>
  <div id="searchbar">
   <table id="searchbartable">
    <tr>
     <td colspan="2">
      <!--googleoff: index-->
      <div xmlns:adobe="http://www.adobe.com/saxon">
       <div id="pdf">
        <img height="16" src="images/PDF.gif" width="16"/>
        <a href="as3_devguide.pdf" title="View Help PDF">
         View Help PDF (
          18M
         B)
        </a>
       </div>
      </div>
      <!--googleon: index-->
     </td>
    </tr>
   </table>
  </div>
  <!-- BEGIN SEARCH CONTENT -->
  <form action="https://help.adobe.com/en_US/as3/dev/search.html" id="search" name="search" target="_self">
   <script type="text/javascript">
    <!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
}

// ]]-->
   </script>
  </form>
  <!-- END SEARCH CONTENT -->
  <!-- BEGIN PAGE CONTENT WRAPPER -->
  <div id="page_content_wrapper">
   <!-- BEGIN PAGE WRAPPER -->
   <table id="page_content_table">
    <tr>
     
     <td id="col2">
      <!-- BEGIN CONTENT WRAPPER -->
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118676a5be7-8000.html" title="Using digital rights management">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7cdb.html" title="DRM-related members and events of the NetStream class">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          ActionScript 3.0 Developer’s Guide
         </b>
        </a>
        /
        <a href="WS9b644acd4ebe59995e75a2e812257746e5a-8000.html">
         <b>
          Rich Media Content
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118676a5be7-8000.html">
         <b>
          Using digital rights management
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <div id="content_wrapper">
       <!-- BEGIN PAGE TITLE -->
       <h1>
        Understanding the protected content workflow
       </h1>
       <p class="adoberuntime">
        Flash Player 10.1 and later, Adobe AIR 2.0 and
later
       </p>
       <!-- END PAGE TITLE -->
       <!-- BEGIN IONCOMMENTCOUNT -->
       <div id="ionCount">
       </div>
       <!-- END IONCOMMENTCOUNT -->
       <table border="0" cellpadding="0" cellspacing="0" id="inner_content_table" width="100%">
        <tr>
         <td>
          <div style="border-top:#ccc solid 1px;">
           <p>
           </p>
          </div>
          <p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>


          <div id="minitoc">
           <div class="t">
            <div class="b">
             <div>
              <ul id="minitoc-links">
               <li>
                <p>
                 <a href="#WSa3a415adbae4e49c-513a8af0126e28a784c-8000">
                  <span class="topictitle1">
                   Detailed API workflow
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5262178513756206-77f1c8d6131d77c08b2-8000">
                  <span class="topictitle1">
                   DRMContentData and session objects
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS7568cbd5c81a0ea6727c378212706ac29cc-8000">
                  <span class="topictitle1">
                   DRM-related events
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WSe3d2d52902616553-3a6b491211d1b2ce8d5-8000">
                  <span class="topictitle1">
                   Pre-loading vouchers for offline playback
                  </span>
                 </a>
                </p>
                <ul>
                 <li>
                  <p>
                   <a href="#WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-8000">
                    <span class="topictitle2">
                     Using DRMContentData
                    </span>
                   </a>
                  </p>
                 </li>
                 <li>
                  <p>
                   <a href="#WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-7fff">
                    <span class="topictitle2">
                     Using preloadEmbeddedMetadata()
                    </span>
                   </a>
                  </p>
                 </li>
                </ul>
               </li>
              </ul>
             </div>
            </div>
           </div>
          </div>
          <div>
           <p>
            <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
             <strong>
              Important
             </strong>
            </i>
            : Flash Player 11.5 and above integrates
the Adobe Access module, so the update step (calling
            <samp class="codeph">
             SystemUpdater.update(SystemUpdaterType.DRM)
            </samp>
            )
is unnecessary. This includes the following browsers and platforms:
           </p>
           <ul>
            <li>
             <p>
              Flash Player 11.5 ActiveX control, for all platforms
except Internet Explorer on Windows 8 on Intel processors
             </p>
            </li>
            <li>
             <p>
              Flash Player 11.5 plugin, for all browsers
             </p>
            </li>
            <li>
             <p>
              Adobe AIR (desktop and mobile)
             </p>
            </li>
           </ul>
           <p>
            This means that the update step is
            <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
             still required
            </i>
            in the
following cases:
           </p>
           <ul>
            <li>
             <p>
              Internet Explorer on Windows 8 on Intel processors
             </p>
            </li>
            <li>
             <p>
              Flash Player 11.4 and below, except on Google Chrome 22 and
above (all platforms) or 21 and above (Windows)
             </p>
            </li>
           </ul>
           <div class="note">
            <span class="notetitle">
             Note:
            </span>
            You can still safely call
            <samp class="codeph">
             SystemUpdater.update(SystemUpdaterType.DRM)
            </samp>
            on
a system with Flash Player 11.5 or higher, but nothing is downloaded.
           </div>
           <p>
            The following high-level workflow shows that how an application
can retrieve and play protected content. The workflow assumes that
the application is designed specifically to play content protected
by Adobe Access:
           </p>
           <div class="para">
            <ol>
             <li>
              <p>
               Get the content metadata.
              </p>
             </li>
             <li>
              <p>
               Handle updates to Flash Player, if needed.
              </p>
             </li>
             <li>
              <p>
               Check if a license is available locally. If so, load it and
go to step 7. If not, go to step 4.
              </p>
             </li>
             <li>
              <p>
               Check if authentication is required. If not, you can go to
step 7.
              </p>
             </li>
             <li>
              <p>
               If authentication is required, get the authentication credentials
from the user and pass them to the license server.
              </p>
             </li>
             <li>
              <p>
               If domain registration is required, join the domain (AIR
3.0 and higher).
              </p>
             </li>
             <li>
              <p>
               Once authentication succeeds, download the license from the
server.
              </p>
             </li>
             <li>
              <p>
               Play the content.
              </p>
             </li>
            </ol>
           </div>
           <p>
            If an error has not occurred and the user was successfully authorized
to view the content, the NetStream object dispatches a DRMStatusEvent
object. The application then begins playback. The DRMStatusEvent
object holds the related voucher information, which identifies the
user’s policy and permissions. For example, it holds information
regarding whether the content can be made available offline or when
the license expires. The application can use this data to inform
the user of the status of their policy. For example, the application
can display the number of remaining days the user has for viewing
the content in a status bar.
           </p>
           <p>
            If the user is allowed offline access, the voucher is cached,
and the encrypted content is downloaded to the user’s machine. The
content is made accessible for the duration defined in the license
caching duration. The
            <samp class="codeph">
             detail
            </samp>
            property in the event
contains
            <samp class="codeph">
             "DRM.voucherObtained"
            </samp>
            . The application
decides where to store the content locally in order for it to be
available offline. You can also preload vouchers using the DRMManager
class.
           </p>
           <div class="para">
            <div class="note">
             <span class="notetitle">
              Note:
             </span>
             Caching and pre-loading of vouchers is supported in both
AIR and Flash Player. However, downloading and storing encrypted
content is supported only in AIR.
            </div>
           </div>
           <p>
            It is the application’s responsibility to explicitly handle the
error events. These events include cases where the user inputs valid
credentials, but the voucher protecting the encrypted content restricts
the access to the content. For example, an authenticated user cannot
access content if the rights have not been paid for. This case can
also occur when two registered members of the same publisher attempt
to share content that only one of them has paid for. The application
must inform the user of the error and provide an alternative suggestion.
A typical alternative suggestion is instructions in how to register
and pay for viewing rights.
           </p>
          </div>
          <div class="nochunk" id="WSa3a415adbae4e49c-513a8af0126e28a784c-8000">
           <a name="WSa3a415adbae4e49c-513a8af0126e28a784c-8000">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Detailed API workflow
           </h2>
           <div>
            <p>
             This workflow provides a more detailed view of the protected-content
workflow. This workflow describes the specific APIs used to play
content protected by Adobe Access.
            </p>
            <div class="para">
             <ol>
              <li>
               <p>
                Using a URLLoader object, load the bytes of the protected
content’s metadata file. Set this object to a variable, such as
                <samp class="codeph">
                 metadata_bytes
                </samp>
                .
               </p>
               <p>
                All
content controlled by Adobe Access has Adobe Access metadata. When
the content is packaged, this metadata can be saved as a separate
metadata file (.metadata) alongside the content. For more information,
see the Adobe Access documentation.
               </p>
              </li>
              <li>
               <p>
                Create a DRMContentData instance. Put this code into a try-catch
block:
               </p>
               <p>
                <samp class="codeph">
                 new DRMContentData(
                 <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                  metadata_bytes
                 </i>
                 )
                </samp>
               </p>
               <p>
                where
                <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                 <samp class="codeph">
                  metadata_bytes
                 </samp>
                </i>
                is
the URLLoader object obtained in step 1.
               </p>
              </li>
              <li>
               <p>
                (Flash Player only) The runtime checks for the Adobe Access
module. If not found, an IllegalOperationError with DRMErrorEvent
error code 3344 or DRMErrorEvent error code 3343 is thrown.
               </p>
               <p>
                To
handle this error, download the Adobe Access module using the SystemUpdater
API. After this module is downloaded, the SystemUpdater object dispatches
a COMPLETE event. Include an event listener for this event that returns
to step 2 when this event is dispatched. The following code demonstrates
these steps:
               </p>
               <div class="para">
                <pre>flash.system.SystemUpdater.addEventListener(Event.COMPLETE, updateCompleteHandler); 
flash.system.SystemUpdater.update(flash.system.SystemUpdaterType.DRM)</pre>
               </div>
               <pre>private function updateCompleteHandler (event:Event):void { 
    /*redo step 2*/ 
    drmContentData = new DRMContentData(metadata_bytes); 
} </pre>
               <p>
                If the player itself must be updated, a status
event is dispatched. For more information on handling this event,
see
                <a href="WS7568cbd5c81a0ea63cf5bc1d126d9ba3f10-8000.html">
                 Listening for an update event
                </a>
                .
               </p>
               <div class="note">
                <span class="notetitle">
                 Note:
                </span>
                In AIR applications, the AIR
installer handles updating the Adobe Access module and required
runtime updates.
               </div>
              </li>
              <li>
               <p>
                Create listeners to listen for the DRMStatusEvent and DRMErrorEvent dispatched
from the DRMManager object:
               </p>
               <pre>DRMManager.addEventListener(DRMStatusEvent.DRM_STATUS, onDRMStatus); 
DRMManager.addEventListener(DRMErrorEvent.DRM_ERROR, onDRMError);</pre>
               <p>
                In
the DRMStatusEvent listener, check that the voucher is valid (not
null). In the DRMErrorEvent listener, handle DRMErrorEvents. See
                <a href="WS5b3ccc516d4fbf351e63e3d118666ade46-7cda.html">
                 Using the DRMStatusEvent class
                </a>
                and
                <a href="WS5b3ccc516d4fbf351e63e3d118666ade46-7cd8.html">
                 Using the DRMErrorEvent class
                </a>
                .
               </p>
              </li>
              <li>
               <p>
                Load the voucher (license) that is required to play the content.
               </p>
               <p>
                First,
try to load a locally stored license to play the content:
               </p>
               <pre>DRMManager.loadvoucher(<i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">drmContentData</i>, LoadVoucherSetting.LOCAL_ONLY)</pre>
               <p>
                After
loading completes, the DRMManager object dispatches
                <samp class="codeph">
                 DRMStatusEvent.DRM_Status
                </samp>
                .
               </p>
              </li>
              <li>
               <p>
                If the DRMVoucher object is not null, the voucher is valid.
Skip to step 13.
               </p>
              </li>
              <li>
               <p>
                If the DRMVoucher object is null, check the authentication
method required by the policy for this content. Use the
                <samp class="codeph">
                 DRMContentData.authenticationMethod
                </samp>
                property.
               </p>
              </li>
              <li>
               <p>
                If the authentication method is
                <samp class="codeph">
                 ANONYMOUS
                </samp>
                ,
go to step 13.
               </p>
              </li>
              <li>
               <p>
                If the authentication method is
                <samp class="codeph">
                 USERNAME_AND_PASSWORD
                </samp>
                ,
your application must provide a mechanism to let the user enter
credentials. Pass these credentials to the license server to authenticate
the user:
               </p>
               <pre>DRMManager.authenticate(<i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">metadata</i>.serverURL, <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">metadata</i>.domain, <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">username</i>, <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">password</i>)</pre>
               <p>
                The
DRMManager dispatches a
                <samp class="codeph">
                 DRMAuthenticationErrorEvent
                </samp>
                if authentication
fails or a
                <samp class="codeph">
                 DRMAuthenticationCompleteEvent
                </samp>
                if authentication
succeeds. Create listeners for these events.
               </p>
              </li>
              <li>
               <p>
                If the authentication method is
                <samp class="codeph">
                 UNKNOWN
                </samp>
                ,
a custom authentication method must be used. In this case, the content
provider has arranged for authentication to be done in an out-of-band
manner by not using the ActionScript 3.0 APIs. The custom authentication
procedure must produce an authentication token that can be passed
to the
                <samp class="codeph">
                 DRMManager.setAuthenticationToken()
                </samp>
                method.
               </p>
              </li>
              <li>
               <p>
                If authentication fails, your application must return to
step 9. Ensure that your application has a mechanism to handle and
limit repeated authentication failures. For example, after three
attempts, you display a message to the user indicating the authentication
has failed and content cannot be played.
               </p>
              </li>
              <li>
               <p>
                To use the stored token instead of prompting the user to
enter credentials, set the token with
                <samp class="codeph">
                 DRMManager.setAuthenticationToken()
                </samp>
                method. You
then download the license from the license server and play content
as in step 8.
               </p>
              </li>
              <li>
               <p>
                (optional) If authentication succeeds, you can capture the
authentication token, which is a byte array cached in memory. Get
this token with the
                <samp class="codeph">
                 DRMAuthenticationCompleteEvent.token
                </samp>
                property.
You can store and use the authentication token so that the user
does not have to repeatedly enter credentials for this content.
The license server determines the valid period of the authentication
token.
               </p>
              </li>
              <li>
               <p>
                If authentication succeeds, download the license from the
license server:
               </p>
               <pre>DRMManager.loadvoucher(<i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">drmContentData</i>, LoadVoucherSetting.FORCE_REFRESH)</pre>
               <p>
                After
loading completes, the DRMManager object dispatches DRMStatusEvent.DRM_STATUS.
Listen for this event, and when it is dispatched, you can play the
content.
               </p>
              </li>
              <li>
               <p>
                Play the video by creating a NetStream object and then calling
its
                <samp class="codeph">
                 play()
                </samp>
                method:
               </p>
               <pre>stream = new NetStream(connection); 
stream.addEventListener(DRMStatusEvent.DRM _STATUS, drmStatusHandler); 
stream.addEventListener(DRMErrorEvent.DRM_ERROR, drmErrorHandler); 
stream.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler); 
stream.client = new CustomClient(); 
video.attachNetStream(stream); 
stream.play(videoURL); </pre>
              </li>
             </ol>
            </div>
           </div>
          </div>
          <div class="nochunk" id="WS5262178513756206-77f1c8d6131d77c08b2-8000">
           <a name="WS5262178513756206-77f1c8d6131d77c08b2-8000">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            DRMContentData and session objects
           </h2>
           <div>
            <div class="para">
             When
             <samp class="codeph">
              DRMContentData
             </samp>
             is created, it will
be used as a session object that refers to the Flash Player DRM
module. All the
             <samp class="codeph">
              DRMManager
             </samp>
             APIs that receives this
             <samp class="codeph">
              DRMContentData
             </samp>
             will
use that particular DRM module. However, there are 2
             <samp class="codeph">
              DRMManager
             </samp>
             APIs
that does not use
             <samp class="codeph">
              DRMContentData
             </samp>
             . They are:
             <ol>
              <li>
               <p>
                <samp class="codeph">
                 authenticate()
                </samp>
               </p>
              </li>
              <li>
               <p>
                <samp class="codeph">
                 setAuthenticationToken()
                </samp>
               </p>
              </li>
             </ol>
            </div>
            <div class="para">
             Since there is no
             <samp class="codeph">
              DRMContentData
             </samp>
             associated,
invoking these
             <samp class="codeph">
              DRMManager
             </samp>
             APIs will use the latest
DRM module from the disk. This may become a problem if an update
of the DRM module happens in the middle of the application’s DRM workflow.
Consider the following scenario:
             <ol>
              <li>
               <p>
                The application creates
a
                <samp class="codeph">
                 DRMContentData
                </samp>
                object
                <samp class="codeph">
                 contentData1
                </samp>
                ,
which uses
                <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                 AdobeCP1
                </i>
                as the DRM module.
               </p>
              </li>
              <li>
               <p>
                The application invokes the
                <samp class="codeph">
                 DRMManager.authenticate(contentData1.serverURL,...)
                </samp>
                method.
               </p>
              </li>
              <li>
               <p>
                The application invokes the
                <samp class="codeph">
                 DRMManager.loadVoucher(contentData1, ...)
                </samp>
                method.
               </p>
              </li>
             </ol>
            </div>
            <p>
             If an update happens for the DRM module before the application
can get to step 2, then the
             <samp class="codeph">
              DRMManager.authenticate()
             </samp>
             method
will end up authenticating using
             <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
              AdobeCP2
             </i>
             as the DRM module.
The
             <samp class="codeph">
              loadVoucher()
             </samp>
             method in step 3 will fail since
it is still using
             <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
              AdobeCP1
             </i>
             as the DRM module. The update
may have happened due to another application invoking the DRM module update.You
can avoid this scenario by invoking the DRM module update on application
startup.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS7568cbd5c81a0ea6727c378212706ac29cc-8000">
           <a name="WS7568cbd5c81a0ea6727c378212706ac29cc-8000">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            DRM-related events
           </h2>
           <div>
            <p>
             The runtime dispatches numerous events when
an application attempts to play protected content:
            </p>
            <div class="para">
             <ul>
              <li>
               <p>
                DRMDeviceGroupErrorEvent (AIR only), dispatched by
DRMManager
               </p>
              </li>
              <li>
               <p>
                DRMAuthenticateEvent (AIR only), dispatched by NetStream
               </p>
              </li>
              <li>
               <p>
                DRMAuthenticationCompleteEvent, dispatched by DRMManager
               </p>
              </li>
              <li>
               <p>
                DRMAuthenticationErrorEvent, dispatched by DRMManager
               </p>
              </li>
              <li>
               <p>
                DRMErrorEvent, dispatched by NetStream and DRMManager
               </p>
              </li>
              <li>
               <p>
                DRMStatusEvent, dispatched by NetStream and DRMManager
               </p>
              </li>
              <li>
               <p>
                StatusEvent
               </p>
              </li>
              <li>
               <p>
                NetStatusEvent. See
                <a href="WS7568cbd5c81a0ea63cf5bc1d126d9ba3f10-8000.html">
                 Listening for an update event
                </a>
               </p>
              </li>
             </ul>
            </div>
            <p>
             To support content protected by Adobe Access, add event listeners
for handling the DRM events.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WSe3d2d52902616553-3a6b491211d1b2ce8d5-8000">
           <a name="WSe3d2d52902616553-3a6b491211d1b2ce8d5-8000">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Pre-loading vouchers for offline playback
           </h2>
           <div>
            <p>
             You can preload the vouchers
(licenses) required to play content protected by Adobe Access. Pre-loaded
vouchers allow users to view the content whether they have an active
Internet connection. (The preload process itself requires an Internet
connection.) You can use the NetStream class
             <samp class="codeph">
              preloadEmbeddedMetadata()
             </samp>
             method
and the DRMManager class to preload vouchers. In AIR 2.0 and later,
you can use a DRMContentData object to preload vouchers directly.
This technique is preferable because it lets you update the DRMContentData
object independent of the content. (The
             <samp class="codeph">
              preloadEmbeddedData()
             </samp>
             method
fetches DRMContentData from the content.)
            </p>
           </div>
           <div class="nochunk" id="WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-8000">
            <a name="WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-8000">
             <!-- -->
            </a>
            <h3 class="topictitle3">
             Using DRMContentData
            </h3>
            <div>
             <p>
              The following steps describe the workflow for pre-loading the
voucher for a protected media file using a DRMContentData object.
             </p>
             <ol>
              <li>
               <p>
                Get the binary metadata for the packaged content. If
using the Adobe Access Java Reference Packager, this metadata file
is automatically generated with a
                <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                 .metadata
                </i>
                extension. You
could, for example, download this metadata using the URLLoader class.
               </p>
              </li>
              <li>
               <p>
                Create a DRMContentData object, passing the metadata to the
constructor function:
               </p>
               <pre>var drmData:DRMContentData = new DRMContentData( metadata );</pre>
              </li>
              <li>
               <p>
                The rest of the steps are identical to the workflow described
in
                <a href="WS5b3ccc516d4fbf351e63e3d118666ade46-7ce3.html">
                 Understanding the protected content workflow
                </a>
                .
               </p>
              </li>
             </ol>
            </div>
           </div>
           <div class="nochunk" id="WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-7fff">
            <a name="WS7568cbd5c81a0ea6-21a30ef9126fc608f6e-7fff">
             <!-- -->
            </a>
            <h3 class="topictitle3">
             Using preloadEmbeddedMetadata()
            </h3>
            <div>
             <p>
              The following steps describe the workflow for pre-loading the
voucher for a DRM-protected media file using
              <samp class="codeph">
               preloadEmbeddedMetadata()
              </samp>
              :
             </p>
             <ol>
              <li>
               <p>
                Download and store the media file. (DRM metadata can
only be pre-loaded from locally stored files.)
               </p>
              </li>
              <li>
               <p>
                Create the NetConnection and NetStream objects, supplying
implementations for the
                <samp class="codeph">
                 onDRMContentData()
                </samp>
                and
                <samp class="codeph">
                 onPlayStatus()
                </samp>
                callback functions
of the NetStream client object.
               </p>
              </li>
              <li>
               <p>
                Create a NetStreamPlayOptions object and set the
                <samp class="codeph">
                 stream
                </samp>
                property
to the URL of the local media file.
               </p>
              </li>
              <li>
               <p>
                Call the NetStream
                <samp class="codeph">
                 preloadEmbeddedMetadata()
                </samp>
                ,
passing in the NetStreamPlayOptions object identifying the media
file to parse.
               </p>
              </li>
              <li>
               <p>
                If the media file contains DRM metadata, then the
                <samp class="codeph">
                 onDRMContentData()
                </samp>
                callback
function is invoked. The metadata is passed to this function as
a DRMContentData object.
               </p>
              </li>
              <li>
               <p>
                Use the DRMContentData object to obtain the voucher using
the DRMManager
                <samp class="codeph">
                 loadVoucher()
                </samp>
                method.
               </p>
               <p>
                If the
value of the
                <samp class="codeph">
                 authenticationMethod
                </samp>
                property of the
                <samp class="codeph">
                 DRMContentData
                </samp>
                object
is
                <samp class="codeph">
                 flash.net.drm.AuthenticationMethod.USERNAME_AND_PASSWORD
                </samp>
                ,
authenticate the user on the media rights server before loading
the voucher. The
                <samp class="codeph">
                 serverURL
                </samp>
                and
                <samp class="codeph">
                 domain
                </samp>
                properties
of the DRMContentData object can be passed to the DRMManager
                <samp class="codeph">
                 authenticate()
                </samp>
                method,
along with the user’s credentials.
               </p>
              </li>
              <li>
               <p>
                The
                <samp class="codeph">
                 onPlayStatus()
                </samp>
                callback function is
invoked when file parsing is complete. If the
                <samp class="codeph">
                 onDRMContentData()
                </samp>
                function
has not been called, the file does not contain the metadata required
to obtain a voucher. This missing call also possibly means that
Adobe Access does not protect this file.
               </p>
              </li>
             </ol>
             <p>
              The following code example for AIR illustrates how to preload
a voucher for a local media file:
             </p>
             <pre>package 
{ 
import flash.display.Sprite; 
import flash.events.DRMAuthenticationCompleteEvent; 
import flash.events.DRMAuthenticationErrorEvent; 
import flash.events.DRMErrorEvent;   
import flash.ev ents.DRMStatusEvent; 
import flash.events.NetStatusEvent; 
import flash.net.NetConnection; 
import flash.net.NetStream; 
import flash.net.NetStreamPlayOptions; 
import flash.net.drm.AuthenticationMethod; 
import flash.net.drm.DRMContentData; 
import flash.net.drm.DRMManager; 
import flash.net.drm.LoadVoucherSetting;   
public class DRMPreloader extends Sprite  
{ 
     private var videoURL:String = "app-storage:/video.flv"; 
    private var userName:String = "user"; 
    private var password:String = "password";  
    private var preloadConnection:NetConnection; 
    private var preloadStream:NetStream; 
    private var drmManager:DRMManager = DRMManager.getDRMManager(); 
    private var drmContentData:DRMContentData; 
    public function DRMPreloader():void { 
        drmManager.addEventListener( 
            DRMAuthenticationCompleteEvent.AUTHENTICATION_COMPLETE, 
            onAuthenticationComplete); 
        drmManager.addEventListener(DRMAuthenticationErrorEvent.AUTHENTICATION_ERROR, 
            onAuthenticationError);             
        drmManager.addEventListener(DRMStatusEvent.DRM_STATUS, onDRMStatus); 
        drmManager.addEventListener(DRMErrorEvent.DRM_ERROR, onDRMError); 
        preloadConnection = new NetConnection(); 
        preloadConnection.addEventListener(NetStatusEvent.NET_STATUS, onConnect); 
        preloadConnection.connect(null);            
    } 
 
    private function onConnect( event:NetStatusEvent ):void 
    { 
        preloadMetadata(); 
    } 
    private function preloadMetadata():void 
    { 
        preloadStream = new NetStream( preloadConnection ); 
        preloadStream.client = this; 
        var options:NetStreamPlayOptions = new NetStreamPlayOptions(); 
        options.streamName = videoURL; 
        preloadStream.preloadEmbeddedData( options );                         
    }     
    public function onDRMContentData( drmMetadata:DRMContentData ):void 
    { 
        drmContentData = drmMetadata; 
        if ( drmMetadata.authenticationMethod == AuthenticationMethod.USERNAME_AND_PASSWORD ) 
        { 
            authenticateUser(); 
        } 
        else 
            { 
                getVoucher(); 
            } 
    } 
    private function getVoucher():void 
    { 
        drmManager.loadVoucher( drmContentData, LoadVoucherSetting.ALLOW_SERVER ); 
    } 
 
    private function authenticateUser():void 
    { 
        drmManager.authenticate( drmContentData.serverURL, drmContentData.domain, userName, password ); 
    } 
    private function onAuthenticationError( event:DRMAuthenticationErrorEvent ):void 
    { 
        trace( "Authentication error: " + event.errorID + ", " + event.subErrorID ); 
    } 
 
    private function onAuthenticationComplete( event:DRMAuthenticationCompleteEvent ):void 
    { 
        trace( "Authenticated to: " + event.serverURL + ", domain: " + event.domain ); 
        getVoucher(); 
    } 
    private function onDRMStatus( event:DRMStatusEvent ):void 
    { 
        trace( "DRM Status: " + event.detail); 
        trace("--Voucher allows offline playback = " + event.isAvailableOffline ); 
        trace("--Voucher already cached          = " + event.isLocal ); 
        trace("--Voucher required authentication = " + !event.isAnonymous ); 
    } 
    private function onDRMError( event:DRMErrorEvent ):void 
    { 
        trace( "DRM error event: " + event.errorID + ", " + event.subErrorID + ", " + event.text ); 
    } 
    public function onPlayStatus( info:Object ):void 
    { 
        preloadStream.close(); 
    } 
} 
}</pre>
            </div>
           </div>
          </div>
          <!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
          <!-- END USER PREFERENCES -->
          <div id="related">
           <div class="separator">
            <a href="#top">
             <img src="images/BTT.jpg"/>
            </a>
           </div>
          </div>
          <div id="footer">
           <!-- BEGIN IONCOMMENTS -->
           <div id="ionComHere">
           </div>
           <!-- END IONCOMMENTS -->
           

           <p id="creativecommons">
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text">
             <img alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" id="creativecommons_img" src="images/CC.png"/>
            </a>
            Twitter™ and Facebook posts are not covered under the terms of Creative Commons.
           </p>
          </div>
         </td>
         <td width="10px">
         </td>
         <td id="inner_rightcolumn">
          
         </td>
        </tr>
       </table>
      </div>
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118676a5be7-8000.html" title="Using digital rights management">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118666ade46-7cdb.html" title="DRM-related members and events of the NetStream class">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          ActionScript 3.0 Developer’s Guide
         </b>
        </a>
        /
        <a href="WS9b644acd4ebe59995e75a2e812257746e5a-8000.html">
         <b>
          Rich Media Content
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118676a5be7-8000.html">
         <b>
          Using digital rights management
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <!-- END CONTENT WRAPPER -->
      
     </td>
     <td id="col3">
      <div>
       <img src="images/adobe-lq.png"/>
      </div>
     </td>
    </tr>
   </table>
  </div>
  <!-- END PAGE CONTENT WRAPPER -->
  <script type="text/javascript">
   <!--[CDATA[
scrollToNameAnchor();
// ]]-->
  </script>
  <!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/framemaker/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
		path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



  <style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 


remove_all_cookies();

function remove_all_cookies() {
	var res = document.cookie;
    var multiple = res.split(";");
    for(var i = 0; i < multiple.length; i++) {
    	var key = multiple[i].split("=");
        document.cookie = key[0]+" =; expires = Thu, 01 Jan 1970 00:00:00 UTC";
    }
}


</script>
</p>


  
<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>

//  Ethnio survey code removed
  
  
 </body>
</html>