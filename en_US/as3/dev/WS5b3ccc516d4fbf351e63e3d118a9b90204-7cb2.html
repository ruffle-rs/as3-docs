<?xml version="1.0" encoding="UTF-8"?>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- saved from url=(0022)http://help.adobe.com/ -->
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="en-us" name="lang"/>
  <meta content="livedocs" name="area"/>
  <title>
   Adobe Flash Platform * Using the ExternalInterface class
  </title>
  <link href="https://help.adobe.com/en_US/as3/dev/images/FlashRuntimeLinkIndicator.png" rel="shortcut icon"/>
  <meta content="ActionScript 3.0 Developer’s Guide" name="book"/>
  <meta content="adobe" name="product"/>
  <meta content="air" name="product"/>
  <meta content="flash" name="product"/>
  <meta content="flex" name="product"/>
  <meta content="" name="keywords"/>
  <!--<PageMap><DataObject type="document"><Attribute name="product" value="adobe"></Attribute><Attribute name="product" value="air"></Attribute><Attribute name="product" value="flash"></Attribute><Attribute name="product" value="flex"></Attribute><Attribute name="book" value="ActionScript 3.0 Developer’s Guide"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
  <script charset="UTF-8" language="Javascript" type="text/javascript">
   <!--[CDATA[
        var currentTreeNode = "WS5b3ccc516d4fbf351e63e3d118a9b90204-7cb2.html";
// ]]-->
  </script>
  <script charset="UTF-8" language="Javascript" src="terms.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="help.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="utilities.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="event.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="treeview.js" type="text/javascript">
   ...
  </script>
  <script charset="UTF-8" language="Javascript" src="toc.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="swfobject.js" type="text/javascript">
   ..
  </script>
  <script charset="UTF-8" language="Javascript" src="booklist.js" type="text/javascript">
   ..
  </script>
  <script type="text/javascript">
   <!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
  </script>
  
<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	//document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
    // DO NOTHING
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->


  
  
  <link href="tree.css" rel="stylesheet" type="text/css"/>
  <link href="content.css" rel="stylesheet" type="text/css"/>
  <link href="localeSpecific.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="content_body" onload="window.focus();">
  <a name="top" shape="rect">
   <!--LeaveCommentHere-->
  </a>
  <div id="mnemonic">
   <!--googleoff: index-->
   <div class="FlashRuntime" xmlns:adobe="http://www.adobe.com/saxon">
    <div class="banner">
     <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
      Adobe Flash Platform
     </a>
    </div>
   </div>
   <!--googleon: index-->
  </div>
  <div id="searchbar">
   <table id="searchbartable">
    <tr>
     <td colspan="2">
      <!--googleoff: index-->
      <div xmlns:adobe="http://www.adobe.com/saxon">
       <div id="pdf">
        <img height="16" src="images/PDF.gif" width="16"/>
        <a href="as3_devguide.pdf" title="View Help PDF">
         View Help PDF (
          18M
         B)
        </a>
       </div>
      </div>
      <!--googleon: index-->
     </td>
    </tr>
   </table>
  </div>
  <!-- BEGIN SEARCH CONTENT -->
  <form action="https://help.adobe.com/en_US/as3/dev/search.html" id="search" name="search" target="_self">
   <script type="text/javascript">
    <!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
}

// ]]-->
   </script>
  </form>
  <!-- END SEARCH CONTENT -->
  <!-- BEGIN PAGE CONTENT WRAPPER -->
  <div id="page_content_wrapper">
   <!-- BEGIN PAGE WRAPPER -->
   <table id="page_content_table">
    <tr>
     
     <td id="col2">
      <!-- BEGIN CONTENT WRAPPER -->
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7cab.html" title="External API requirements and advantages">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7cb1.html" title="External API example: Communicating between ActionScript and JavaScript in a web browser">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          ActionScript 3.0 Developer’s Guide
         </b>
        </a>
        /
        <a href="WSd75bf4610ec9e22f-698d6e6b1221382befb-8000.html">
         <b>
          Networking and communication
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118a9b8fc4e-8000.html">
         <b>
          Using the external API
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <div id="content_wrapper">
       <!-- BEGIN PAGE TITLE -->
       <h1>
        Using the ExternalInterface class
       </h1>
       <p class="adoberuntime">
        Flash Player 9 and later, Adobe AIR 1.0 and
later
       </p>
       <!-- END PAGE TITLE -->
       <!-- BEGIN IONCOMMENTCOUNT -->
       <div id="ionCount">
       </div>
       <!-- END IONCOMMENTCOUNT -->
       <table border="0" cellpadding="0" cellspacing="0" id="inner_content_table" width="100%">
        <tr>
         <td>
          <div style="border-top:#ccc solid 1px;">
           <p>
           </p>
          </div>
          <p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>


          <div id="minitoc">
           <div class="t">
            <div class="b">
             <div>
              <ul id="minitoc-links">
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca9">
                  <span class="topictitle1">
                   Getting information about the external container
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca8">
                  <span class="topictitle1">
                   Calling external code from ActionScript
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca7">
                  <span class="topictitle1">
                   Calling ActionScript code from the container
                  </span>
                 </a>
                </p>
               </li>
               <li>
                <p>
                 <a href="#WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf">
                  <span class="topictitle1">
                   The external API’s XML format
                  </span>
                 </a>
                </p>
               </li>
              </ul>
             </div>
            </div>
           </div>
          </div>
          <div>
           <p>
            Communication between ActionScript and the container application
can take one of two forms: either ActionScript can call code (such
as a JavaScript function) defined in the container, or code in the
container can call an ActionScript function that has been designated
as being callable. In either case, information can be sent to the
code being called, and results can be returned to the code making
the call.
           </p>
           <p>
            To facilitate this communication, the ExternalInterface class
includes two static properties and two static methods. These properties
and methods are used to obtain information about the external interface
connection, to execute code in the container from ActionScript,
and to make ActionScript functions available to be called by the
container.
           </p>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca9">
           <a name="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca9">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Getting information about the external container
           </h2>
           <div>
            <p>
             The
             <samp class="codeph">
              ExternalInterface.available
             </samp>
             property
indicates whether the current Flash Player is in a container that
offers an external interface. If the external interface is available,
this property is
             <samp class="codeph">
              true
             </samp>
             ; otherwise, it is
             <samp class="codeph">
              false
             </samp>
             . Before
using any of the other functionality in the ExternalInterface class,
you should always check to make sure that the current container
supports external interface communication, as follows:
            </p>
            <pre>if (ExternalInterface.available) 
{ 
    // Perform ExternalInterface method calls here. 
}</pre>
            <div class="note">
             <span class="notetitle">
              Note:
             </span>
             The
             <samp class="codeph">
              ExternalInterface.available
             </samp>
             property
reports whether the current container is a type that supports ExternalInterface
connectivity. It doesn’t tell you if JavaScript is enabled in the
current browser.
            </div>
            <p>
             The
             <samp class="codeph">
              ExternalInterface.objectID
             </samp>
             property allows
you to determine the unique identifier of the Flash Player instance
(specifically, the
             <samp class="codeph">
              id
             </samp>
             attribute of the
             <samp class="codeph">
              object
             </samp>
             tag
in Internet Explorer or the
             <samp class="codeph">
              name
             </samp>
             attribute of the
             <samp class="codeph">
              embed
             </samp>
             tag
in browsers using the NPRuntime interface). This unique ID represents
the current SWF document in the browser, and can be used to make
reference to the SWF document—for example, when calling a JavaScript
function in a container HTML page. When the Flash Player container
is not a web browser, this property is
             <samp class="codeph">
              null
             </samp>
             .
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca8">
           <a name="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca8">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Calling external code from ActionScript
           </h2>
           <div>
            <p>
             The
             <samp class="codeph">
              ExternalInterface.call()
             </samp>
             method
executes code in the container application. It requires at least
one parameter, a string containing the name of the function to be
called in the container application. Any additional parameters passed
to the
             <samp class="codeph">
              ExternalInterface.call()
             </samp>
             method are passed
along to the container as parameters of the function call.
            </p>
            <pre>// calls the external function "addNumbers" 
// passing two parameters, and assigning that function's result 
// to the variable "result" 
var param1:uint = 3; 
var param2:uint = 7; 
var result:uint = ExternalInterface.call("addNumbers", param1, param2);</pre>
            <p>
             If the container is an HTML page, this method invokes the JavaScript
function with the specified name, which must be defined in a
             <samp class="codeph">
              script
             </samp>
             element
in the containing HTML page. The return value of the JavaScript
function is passed back to ActionScript.
            </p>
            <pre>&lt;script language="JavaScript"&gt; 
    // adds two numbers, and sends the result back to ActionScript 
    function addNumbers(num1, num2) 
    { 
        return (num1 + num2); 
    } 
&lt;/script&gt;</pre>
            <p>
             If the container is some other ActiveX container, this method
causes the Flash Player ActiveX control to dispatch its
             <samp class="codeph">
              FlashCall
             </samp>
             event.
The specified function name and any parameters are serialized into
an XML string by Flash Player. The container can access that information
in the
             <samp class="codeph">
              request
             </samp>
             property of the event object and
use it to determine how to execute its own code. To return a value
to ActionScript, the container code calls the ActiveX object’s
             <samp class="codeph">
              SetReturnValue()
             </samp>
             method,
passing the result (serialized into an XML string) as a parameter
of that method. For more information about the XML format used for
this communication, see
             <a href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf.html">
              The external API’s XML format
             </a>
             .
            </p>
            <p>
             Whether the container is a web browser or another ActiveX container,
if the call fails or the container method does not specify a return
value,
             <samp class="codeph">
              null
             </samp>
             is returned. The
             <samp class="codeph">
              ExternalInterface.call()
             </samp>
             method
throws a SecurityError exception if the containing environment belongs
to a security sandbox to which the calling code does not have access.
You can work around this by setting an appropriate value for
             <samp class="codeph">
              allowScriptAccess
             </samp>
             in
the containing environment. For example, to change the value of
             <samp class="codeph">
              allowScriptAccess
             </samp>
             in
an HTML page, you would edit the appropriate attribute in the
             <samp class="codeph">
              object
             </samp>
             and
             <samp class="codeph">
              embed
             </samp>
             tags.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca7">
           <a name="WS5b3ccc516d4fbf351e63e3d118a9b90204-7ca7">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            Calling ActionScript code from the container
           </h2>
           <div>
            <p>
             A container can only call ActionScript code that’s in a function—no
other ActionScript code can be called by a container. To call an
ActionScript function from the container application, you must do
two things: register the function with the ExternalInterface class,
and then call it from the container’s code.
            </p>
            <p>
             First, you must register your ActionScript function to indicate
that it should be made available to the container. Use the
             <samp class="codeph">
              ExternalInterface.addCallback()
             </samp>
             method,
as follows:
            </p>
            <pre>function callMe(name:String):String 
{ 
    return "busy signal"; 
} 
ExternalInterface.addCallback("myFunction", callMe);</pre>
            <p>
             The
             <samp class="codeph">
              addCallback()
             </samp>
             method takes two parameters.
The first, a function name as a String, is the name by which the
function will be known to the container. The second parameter is
the actual ActionScript function that will be executed when the
container calls the defined function name. Because these names are
distinct, you can specify a function name that will be used by the
container, even if the actual ActionScript function has a different
name. This is especially useful if the function name is not known—for
example, if an anonymous function is specified, or if the function
to be called is determined at run time.
            </p>
            <p>
             Once an ActionScript function has been registered with the ExternalInterface class,
the container can actually call the function. How this is done varies according
to the type of container. For example, in JavaScript code in a web browser,
the ActionScript function is called using the registered function
name as though it’s a method of the Flash Player browser object
(that is, a method of the JavaScript object representing the
             <samp class="codeph">
              object
             </samp>
             or
             <samp class="codeph">
              embed
             </samp>
             tag).
In other words, parameters are passed and a result is returned as
though a local function is being called.
            </p>
            <pre>&lt;script language="JavaScript"&gt; 
    // callResult gets the value "busy signal" 
    var callResult = flashObject.myFunction("my name"); 
&lt;/script&gt; 
... 
&lt;object id="flashObject"...&gt; 
    ... 
    &lt;embed name="flashObject".../&gt; 
&lt;/object&gt;</pre>
            <p>
             Alternatively, when calling an ActionScript function in a SWF
file running in a desktop application, the registered function name
and any parameters must be serialized into an XML-formatted string.
Then the call is actually performed by calling the
             <samp class="codeph">
              CallFunction()
             </samp>
             method
of the ActiveX control with the XML string as a parameter. For more
information about the XML format used for this communication, see
             <a href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf.html">
              The external API’s XML format
             </a>
             .
            </p>
            <p>
             In either case, the return value of the ActionScript function
is passed back to the container code, either directly as a value
when the caller is JavaScript code in a browser, or serialized as
an XML-formatted string when the caller is an ActiveX container.
            </p>
           </div>
          </div>
          <div class="nochunk" id="WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf">
           <a name="WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf">
            <!-- -->
           </a>
           <h2 class="topictitle2">
            The external API’s XML format
           </h2>
           <div>
            <p>
             Communication between ActionScript
and an application hosting the Shockwave Flash ActiveX control uses
a specific XML format to encode function calls and values. There
are two parts to the XML format used by the external API. One format
is used to represent function calls. Another format is used to represent
individual values; this format is used for parameters in functions
as well as function return values. The XML format for function calls
is used for calls to and from ActionScript. For a function call
from ActionScript, Flash Player passes the XML to the container;
for a call from the container, Flash Player expects the container
application to pass it an XML string in this format. The following
XML fragment shows an example XML-formatted function call:
            </p>
            <pre>&lt;invoke name="functionName" returntype="xml"&gt; 
    &lt;arguments&gt; 
        ... (individual argument values) 
    &lt;/arguments&gt; 
&lt;/invoke&gt;</pre>
            <p>
             The root node is the
             <samp class="codeph">
              invoke
             </samp>
             node. It has two
attributes:
             <samp class="codeph">
              name
             </samp>
             indicates the name of the function
to call, and
             <samp class="codeph">
              returntype
             </samp>
             is always
             <samp class="codeph">
              xml
             </samp>
             .
If the function call includes parameters, the
             <samp class="codeph">
              invoke
             </samp>
             node
has a child
             <samp class="codeph">
              arguments
             </samp>
             node, whose child nodes will
be the parameter values formatted using the individual value format
explained next.
            </p>
            <p>
             Individual values, including function parameters and function
return values, use a formatting scheme that includes data type information
in addition to the actual values. The following table lists ActionScript
classes and the XML format used to encode values of that data type:
            </p>
            <div class="tablenoborder">
             <table border="1" cellpadding="4" cellspacing="0">
              <thead align="left">
               <tr>
                <th id="d17e56092" valign="top" width="NaN%">
                 <p>
                  ActionScript class/value
                 </p>
                </th>
                <th id="d17e56095" valign="top" width="NaN%">
                 <p>
                  C# class/value
                 </p>
                </th>
                <th id="d17e56098" valign="top" width="NaN%">
                 <p>
                  Format
                 </p>
                </th>
                <th id="d17e56101" valign="top" width="NaN%">
                 <p>
                  Comments
                 </p>
                </th>
               </tr>
              </thead>
              <tbody>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  null
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  null
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <p>
                  &lt;null/&gt;
                 </p>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Boolean
                  <samp class="codeph">
                   true
                  </samp>
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  bool true
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <p>
                  &lt;true/&gt;
                 </p>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Boolean
                  <samp class="codeph">
                   false
                  </samp>
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  bool false
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <p>
                  &lt;false/&gt;
                 </p>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  String
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  string
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <p>
                  &lt;string&gt;string value&lt;/string&gt;
                 </p>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Number, int, uint
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  single, double, int, uint
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <div class="para">
                  <pre>&lt;number&gt;27.5&lt;/number&gt; 
&lt;number&gt;-12&lt;/number&gt;</pre>
                 </div>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Array (elements can be mixed types)
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  A collection that allows mixed-type elements, such
as ArrayList or object[]
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <div class="para">
                  <pre>&lt;array&gt; 
    &lt;property id="0"&gt; 
        &lt;number&gt;27.5&lt;/number&gt; 
    &lt;/property&gt; 
    &lt;property id="1"&gt; 
        &lt;string&gt;Hello there!&lt;/string&gt; 
    &lt;/property&gt; 
    ... 
&lt;/array&gt;</pre>
                 </div>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                 <p>
                  The
                  <samp class="codeph">
                   property
                  </samp>
                  node defines
individual elements, and the
                  <samp class="codeph">
                   id
                  </samp>
                  attribute is the numeric,
zero-based index.
                 </p>
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Object
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                 <p>
                  A dictionary with string keys and object
values, such as a HashTable with string keys
                 </p>
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <div class="para">
                  <pre>&lt;object&gt; 
    &lt;property id="name"&gt; 
        &lt;string&gt;John Doe&lt;/string&gt; 
    &lt;/property&gt; 
    &lt;property id="age"&gt; 
        &lt;string&gt;33&lt;/string&gt; 
    &lt;/property&gt; 
    ... 
&lt;/object&gt;</pre>
                 </div>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                 <p>
                  The
                  <samp class="codeph">
                   property
                  </samp>
                  node defines
individual properties, and the
                  <samp class="codeph">
                   id
                  </samp>
                  attribute is
the property name (a string).
                 </p>
                </td>
               </tr>
               <tr>
                <td headers="d17e56092 " valign="top" width="NaN%">
                 <p>
                  Other built-in or custom classes
                 </p>
                </td>
                <td headers="d17e56095 " valign="top" width="NaN%">
                </td>
                <td headers="d17e56098 " valign="top" width="NaN%">
                 <div class="para">
                  <pre>&lt;null/&gt; or  
&lt;object&gt;&lt;/object&gt;</pre>
                 </div>
                </td>
                <td headers="d17e56101 " valign="top" width="NaN%">
                 <p>
                  ActionScript encodes other objects as null or
as an empty object. In either case any property values are lost.
                 </p>
                </td>
               </tr>
              </tbody>
             </table>
            </div>
            <div class="note">
             <span class="notetitle">
              Note:
             </span>
             By way of example, this table shows equivalent
C# classes in addition to ActionScript classes; however, the external
API can be used to communicate with any programming language or
run time that supports ActiveX controls, and is not limited to C#
applications.
            </div>
            <p>
             When you are building your own applications using the external
API with an ActiveX container application, you’ll probably find
it convenient to write a proxy that will perform the task of converting
native function calls to the serialized XML format. For an example
of a proxy class written in C#, see Inside the ExternalInterfaceProxy
class.
            </p>
           </div>
          </div>
          <!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
          <!-- END USER PREFERENCES -->
          <div id="related">
           <div class="separator">
            <a href="#top">
             <img src="images/BTT.jpg"/>
            </a>
           </div>
          </div>
          <div id="footer">
           <!-- BEGIN IONCOMMENTS -->
           <div id="ionComHere">
           </div>
           <!-- END IONCOMMENTS -->
           

           <p id="creativecommons">
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text">
             <img alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" id="creativecommons_img" src="images/CC.png"/>
            </a>
            Twitter™ and Facebook posts are not covered under the terms of Creative Commons.
           </p>
          </div>
         </td>
         <td width="10px">
         </td>
         <td id="inner_rightcolumn">
          
         </td>
        </tr>
       </table>
      </div>
      <!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
       <ul class="navigation">
        <li class="prev">
         <a accesskey="p" class="prev" href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7cab.html" title="External API requirements and advantages">
          <img alt="Previous" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
        <li class="next">
         <a accesskey="n" class="next" href="WS5b3ccc516d4fbf351e63e3d118a9b90204-7cb1.html" title="External API example: Communicating between ActionScript and JavaScript in a web browser">
          <img alt="Next" height="17" src="images/blank.gif" width="17"/>
         </a>
        </li>
       </ul>
       <div class="hierarchy" id="hierarchy">
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          Home
         </b>
        </a>
        /
        <a href="WS9936fa0d5984e93b3f4f38ec1272a447844-8000.html">
         <b>
          ActionScript 3.0 Developer’s Guide
         </b>
        </a>
        /
        <a href="WSd75bf4610ec9e22f-698d6e6b1221382befb-8000.html">
         <b>
          Networking and communication
         </b>
        </a>
        /
        <a href="WS5b3ccc516d4fbf351e63e3d118a9b8fc4e-8000.html">
         <b>
          Using the external API
         </b>
        </a>
       </div>
      </div>
      <!-- END BREADCRUMBS -->
      <!-- END CONTENT WRAPPER -->
      
     </td>
     <td id="col3">
      <div>
       <img src="images/adobe-lq.png"/>
      </div>
     </td>
    </tr>
   </table>
  </div>
  <!-- END PAGE CONTENT WRAPPER -->
  <script type="text/javascript">
   <!--[CDATA[
scrollToNameAnchor();
// ]]-->
  </script>
  <!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/framemaker/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
		path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



  <style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 


remove_all_cookies();

function remove_all_cookies() {
	var res = document.cookie;
    var multiple = res.split(";");
    for(var i = 0; i < multiple.length; i++) {
    	var key = multiple[i].split("=");
        document.cookie = key[0]+" =; expires = Thu, 01 Jan 1970 00:00:00 UTC";
    }
}


</script>
</p>


  
<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>

//  Ethnio survey code removed
  
  
 </body>
</html>